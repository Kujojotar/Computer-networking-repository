# 多路复用和多路分解

在目的主机，运输层从紧邻其下的网络层接收报文段。运输层负责将这些报文段中的数据交付给主机上运行的适当应用进程。

假设计算机中运行着一个FTP会话和两个Telnet会话。这样你就有4个网络应用进程在运行，即两个Telnet进程，一个FTP和一个HTTP。当计算机运输层从底层的网络层接收数据时，它需要将所接收到的数据定向到这4个进程中的一个。

每个套接字都有唯一的标识符，标识符格式取决于其为TCP还是UDP套接字。

![image-20210109105107588](C:\Users\Jonny\AppData\Roaming\Typora\typora-user-images\image-20210109105107588.png)

每个运输层报文中具有几个字段，在接受端，运输层检查这些字段，表示出接收套接字，进而将报文定向到该套接字。将运输层报文段中的数据交付到正确的套接字的工作被称为**多路分解**。在源主机从不同的套接字中收集数据块，并为每个数据块封装上首部信息（以后用于分解），然后将报文段传递到网络层，所有这些工作被称为多路复用。如果存在中间主机也是如此。

多路复用的要求：

1.套接字有唯一的标识符。

2.每个报文端有特殊字符来指示该报文段所要交付的套接字。这些特殊字段是**源端口号字段**和**目的端口号**字段。端口号是一个16比特的数，其大小在0-65535之间。0-1023范围的端口号被称为**周知端口号**，是受限制的，这是指它们保留给诸如HTTP（端口号80）和FTP（端口号21）之类的周知应用层协议使用的。

在主机上的每个套接字能够分配一个端口号，当报文段到达主机时，运输层检查报文段的目的端口号，并将其定向到响应的套接字。然后报文段中的数据通过套接字进入其所连接的进程中。UDP基本上是这样做的，但TCP更为复杂。



